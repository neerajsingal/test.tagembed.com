"use strict";(self.webpackChunkreact1=self.webpackChunkreact1||[]).push([[8955],{68955:(e,t,s)=>{s.r(t),s.d(t,{default:()=>Q});var n=s(9950),a=s(73878),i=s(97937),l=s(45358),o=s(471),d=s(1093),c=s(64323),r=s(51960),h=s(21432),m=s(95942),u=s(34483),p=s(17595),g=s(36431),x=s(42074),v=(s(30615),s(52867)),f=s(44414);n.Component;var y=s(25984),w=s(54810),j=s(80322),A=s(75794),b=s(20878),C=s(35131),N=s(21784),k=s(99637),S=s(67972),E=s(90900),F=s(85608);const I=F.bG,P=F.I2,D=F.jZ,T=F.mD,O=F.ac;class M extends n.Component{constructor(e){super(e),this.onClickToOpen=()=>{this.setState({modalOpen:!0});const e=document.querySelector(".uppy-Dashboard-close");e&&e.addEventListener("click",(()=>{this.uppyPostEdit.cancelAll(),this.setState({modalOpen:!1})}))},this.onClickToClose=()=>{this.uppyPostEdit.cancelAll(),this.setState({modalOpen:!1,renderKey:Math.floor(6*Math.random())+1})};const{uploadPath:t,allowedFile:s,width:n,maxFileSize:a,beforeUpload:i,proceed:l}=e,o=l||!1,d=s||["image/*"],c=n||500,r=a||5e6,h=i||(()=>{}),m=1==d.length&&d.includes("image/*")?{resize:{robot:"/image/resize",width:c,resize_strategy:"fit",background:"none"}}:{};this.state={filename:null,modalOpen:!1,render:0},this.uppyPostEdit=new A.A({debug:!0,autoProceed:o,allowMultipleUploadBatches:!1,restrictions:{maxFileSize:r,maxNumberOfFiles:1,minNumberOfFiles:1,allowedFileTypes:d},onBeforeUpload:h}).use(C.Ay,{target:"#a",params:{auth:{key:I},steps:{...m,store:{robot:"/wasabi/store",bucket_region:"us-west-1",bucket:P,key:D,secret:T,path:`${t}\${file.id}.\${file.ext}`}}},waitForEncoding:!0})}componentDidMount(){const{uploadAgents:e,uploadPath:t,onImgUpload:s,uploadMethods:n}=this.props;e&&e.length>0&&e.forEach((e=>{let t=k.A;"GoogleDrive"==e?t=N.A:"Url"==e?t=S.A:"Webcam"==e&&(t=E.A),this.uppyPostEdit.use(t,{target:A.A.Dashboard,companionUrl:O})})),(null===n||void 0===n?void 0:n.length)>0&&n.forEach((e=>{let{key:t,callback:s}=e;this.uppyPostEdit.on(t,(e=>s(e,this.uppyPostEdit)))})),this.uppyPostEdit.on("transloadit:result",((e,n)=>{const a=`${F.GG}${t}${n.id}.${n.ext}`;this.setState({filename:a},(()=>{setTimeout((()=>{s(a,{...n.meta,fileName:`${n.id}.${n.ext}`,isVideo:Object(null===n||void 0===n?void 0:n.meta).hasOwnProperty("duration")},a),this.uppyPostEdit.cancelAll(),this.setState({modalOpen:!1})}),300)}))}))}componentWillUnmount(){this.uppyPostEdit.cancelAll(),this.uppyPostEdit.close({reason:"unmount"}),this.setState({modalOpen:!1,renderKey:Math.floor(6*Math.random())+1})}render(){const{modalOpen:e,renderKey:t}=this.state,{isModal:s=!0,children:a,uploadAgents:i,showFile:l=!1,disInfo:o=!1,height:d=270}=this.props;return(0,f.jsx)(n.Fragment,{children:s?(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("span",{onClick:this.onClickToOpen,children:a}),(0,f.jsx)(b.KG,{animateOpenClose:!0,proudlyDisplayPoweredByUppy:!1,inline:!1,open:e,showProgressDetails:!0,height:750,browserBackButtonClose:!0,showRemoveButtonAfterComplete:!1,uppy:this.uppyPostEdit,onRequestCloseModal:this.onClickToClose,closeAfterFinish:!0,doneButtonHandler:this.doneButtonHandler,plugins:i})]}):(0,f.jsx)("div",{children:(0,f.jsx)(b.xh,{proudlyDisplayPoweredByUppy:!1,hideUploadButton:!0,showProgressDetails:!0,disableThumbnailGenerator:!1,showRemoveButtonAfterComplete:!1,height:d,uppy:this.uppyPostEdit,plugins:i,showSelectedFiles:l,disableInformer:o},t)})},t)}}const _=M;class L extends n.Component{constructor(e){super(e),this.getConnectAccount=()=>{const{accountList:e,connectedAccount:t}=this.props.feed,s=e.length>0?e.filter((e=>e.id===t)):[];return s.length>0?s[0]:e.length>0?e[0]:{}},this.onModerationSwitch=e=>{const{feed:t,changeStatus:s}=this.props;s(t.id,Number(e),"moderation"),this.setState({moderation:Number(e)})},this.onFeedStatusSwitch=e=>{const{feed:t,changeStatus:s}=this.props;s(t.id,Number(e),"status"),this.setState({status:Number(e)})},this.connectAccount=(e,t)=>{const s={id:e.networkId,name:e.networkName.toLowerCase()};localStorage.setItem("feedId",e.id),t&&localStorage.setItem("refresh",!0),localStorage.setItem("connectionType","manageFeed"),(0,v.go)(s,t,!0)},this.state={moderation:this.props.feed.moderation,status:this.props.feed.status,connectedAccount:this.getConnectAccount()}}componentDidMount(){const{feed:e}=this.props;this.setState({status:e.status,moderation:e.moderation})}componentDidUpdate(e){e.accountChanged!=this.props.accountChanged&&this.setState({connectedAccount:this.getConnectAccount()})}render(){const{feed:e,onFeedDelete:t,changeAccount:s}=this.props,{status:n,moderation:a,connectedAccount:l}=this.state,{filterId:o,networkId:d,accountList:A,isBtntext:b}=e,C=localStorage.getItem("wallId"),N=`media/${localStorage.getItem("ownerId")}/${C}/${e.id}`,k=((e,t)=>18==e||2==e?[23,34,66,1].includes(t):10==e?[17,1,86].includes(t):3==e?[8,1,67,65,66].includes(t):7==e?[1,75].includes(t):28==e?[2,71].includes(t):12==e?[13].includes(t):5==e?[1,71].includes(t):(1==e||8==e||6==e||11==e)&&[1].includes(t))(d,o);return(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{children:(0,f.jsxs)("div",{className:"d-flex align-items-center",children:[(0,f.jsx)("span",{className:"h-34px w-34px me-2 d-flex flex-shrink-0",children:(0,f.jsx)(r.A,{className:"h-100",src:(0,w.pc)(`media/icons/social-icons-square/${(0,v.EC)(e.networkId)}.svg`),height:43,width:43,title:(0,v.Oi)(e.networkId),alt:(0,v.Oi)(e.networkId),fluid:!0})}),(0,f.jsxs)("div",{style:{minWidth:170},children:[(0,f.jsxs)("p",{className:"mb-0 d-flex",children:[(0,f.jsxs)("span",{className:"feed_name fw-semibold",children:[(0,y.Ay)(e.name)," "]}),e.socialLink?(0,f.jsx)(h.A,{placement:"top",overlay:(0,f.jsx)(m.A,{children:e.tooltip}),children:(0,f.jsx)(x.N_,{className:"ms-2 text-muted",to:8!==e.networkId?e.socialLink:`https://vimeo.com/user${e.accountId}`,target:"_blank",title:"support",children:(0,f.jsx)(w.gc,{icon:"arrow-up-right-from-square"})})}):null]}),(0,f.jsx)("small",{className:"mb-0 text-gray-700",children:e.networkName})]})]})}),(0,f.jsx)("td",{children:(0,f.jsxs)("div",{className:"d-flex align-items-center",children:[[1,2,3,4,5,8,65,67,26,23,86].includes(o)&&2!=d&&A&&A.length>0?(0,f.jsxs)(u.A,{style:{minWidth:220},children:[(0,f.jsxs)(u.A.Toggle,{variant:"secondary",size:"sm",className:"d-flex align-items-center w-100 justify-content-between",children:[(0,f.jsxs)("div",{className:"d-flex align-items-center flex-grow-1",children:[(0,f.jsx)(g.A,{className:"symbol symbol-26 symbol-circle flex-shrink-0 me-2",imageSize:26,symbolClass:"symbol-label fs-8",name:l.accountName,profileUrl:l.profilePicture,networkId:d}),(0,f.jsx)("div",{className:"overflow-hidden",style:{maxWidth:130},children:(0,f.jsx)("p",{className:"fw-medium mb-0 text-ellipsis fs-9",children:l.accountName})})]}),"Reconnect"==b||"Connect"==b?(0,f.jsx)(h.A,{overlay:(0,f.jsx)(m.A,{children:"Feed disconnected as the social media account's user name got changed since your last connection with Tagbox. Kindly click on the button below to connect."}),children:(0,f.jsx)("span",{className:"me-1 fs-5 text-danger h-14px w-14px",children:(0,f.jsx)(w.gc,{icon:"circle-info"})})}):null]}),(0,f.jsx)(u.A.Menu,{className:"w-100",children:A.map((t=>{const{id:n,profilePicture:a,accountName:i}=t;return(0,f.jsx)(u.A.Item,{onClick:()=>(0,j.Yj)("networkManager","manageFeed",!0)?s(n,e.id):{},children:(0,f.jsxs)("div",{className:"d-flex align-items-center",children:[(0,f.jsx)(g.A,{className:"symbol symbol-26 symbol-circle flex-shrink-0 me-2",imageSize:26,symbolClass:"symbol-label fs-8",name:i,profileUrl:a,networkId:d}),(0,f.jsx)("div",{className:"overflow-hidden",style:{maxWidth:130},children:(0,f.jsx)("p",{className:"fw-medium mb-0 text-ellipsis fs-9",children:i})})]})},n)}))})]}):"Reconnect"==b||"Connect"==b?null:"--",(0,f.jsx)("div",{className:"d-flex ms-3",children:"Reconnect"==b||"Connect"==b?(0,f.jsx)(h.A,{placement:"top",overlay:(0,f.jsx)(m.A,{children:b}),children:(0,f.jsx)(i.A,{variant:"icon",size:"sm",className:"btn-active-primary","aria-label":b,onClick:()=>(0,j.Yj)("networkManager","manageAccount",!0)?this.connectAccount(e,!0):{},children:(0,f.jsx)(w.gc,{type:"solid",icon:"rotate"})})}):null})]})}),(0,f.jsxs)("td",{children:[(0,f.jsx)("p",{className:"fs-8 fw-semibold mb-0","data-id":"post",style:{minWidth:120},children:e.postCount?e.postCount:0}),(0,f.jsxs)("span",{className:"fs-8 text-gray-700",children:["Approved ",e.postCount>1?"posts":"post"]})]}),(0,f.jsx)("td",{children:(0,f.jsx)(p.A.Check,{type:"switch",checked:a,"data-id":"moderation",onChange:()=>(0,j.Yj)("networkManager","manageFeed",!0)?a?this.onModerationSwitch(!a):(0,v.zO)("Enabling moderation will make all newly received posts private until they are reviewed and approved.",this.onModerationSwitch,!a):{}})}),(0,f.jsx)("td",{children:(0,f.jsx)(p.A.Check,{type:"switch",checked:n,"data-id":"status",onChange:()=>(0,j.Yj)("networkManager","manageFeed",!0)?n?(0,v.zO)("Disabling this status will hide all collected posts from this feed, affecting visibility and content access.",this.onFeedStatusSwitch,!n):this.onFeedStatusSwitch(!n):{}})}),(0,f.jsx)("td",{className:"pr-0",children:(0,f.jsxs)("div",{className:"d-flex justify-content-end",children:[(0,f.jsx)("div",{className:"d-flex align-items-center justify-content-end me-2",children:(0,j.Yj)("networkManager","manageFeed",!0)&&k?(0,f.jsx)(_,{uploadPath:N,uploadAgents:[],onImgUpload:t=>(0,c.CF)(t,e.id),children:(0,f.jsx)(h.A,{placement:"top",overlay:(0,f.jsx)(m.A,{children:"Upload"}),children:(0,f.jsx)(i.A,{variant:"icon",size:"sm","data-id":"edit",className:"btn-active-primary","aria-label":"edit",children:(0,f.jsx)(w.gc,{type:"solid",icon:"edit"})})})}):null}),(0,f.jsx)("div",{className:"d-flex align-items-center justify-content-end",onClick:()=>(0,j.Yj)("networkManager","manageFeed",!0)?t(e.id,e.networkId):{},children:(0,f.jsx)(h.A,{placement:"top",overlay:(0,f.jsx)(m.A,{children:"Delete"}),children:(0,f.jsx)(i.A,{variant:"icon",size:"sm","data-id":"delete",className:"btn-active-primary","aria-label":"delete",children:(0,f.jsx)(w.gc,{type:"solid",icon:"trash-can"})})})})]})})]})}}const U=(0,a.Ng)(null,(e=>({GET_FEEDS:()=>e((0,c.LF)())})))(L);var G=s(18633),$=s(4695),B=s.n($),W=s(9697),z=s(58423),R=s(1391),Y=s(26806),H=s(54480),K=s(91615),q=s(26787);const Z=[{name:"Name",minWidth:150},{name:"Account",minWidth:150},{name:"Posts",minWidth:120},{name:"Moderation",minWidth:50},{name:"Status",minWidth:50},{name:"Actions",minWidth:70,align:"text-end"}];class J extends n.Component{constructor(){super(...arguments),this.state={currentPage:1,showPost:30,totalPage:1,allFeeds:[],currentPageFeeds:null,accountChanged:!1},this.changeTotalPost=e=>{this.setState({showPost:parseInt(e.target.value),currentPage:1},(()=>this.countAllPage()))},this.nextPrev=e=>{this.setState({currentPage:e},(()=>this.countAllPage()))},this.countAllPage=()=>{const{manageFeeds:e}=this.props,t=null===e||void 0===e?void 0:e.feeds;this.setState({allFeeds:t,totalPage:Math.ceil((t&&t.length>0?t.length:0)/this.state.showPost)})},this.changeStatus=(e,t,s)=>{this.props.ACTION_FEED_STATUS(e,t,s,this.onSuccessUpdateRedux)},this.changeAccount=(e,t)=>{this.props.ACTION_UPDATE_SOCIAL_ACCOUNT(e,t,this.onSuccessUpdateRedux)},this.onSuccessUpdateRedux=e=>{this.props.getModeration(),this.countAllPage(),"account"==e&&this.setState({accountChanged:!this.state.accountChanged})},this.onFeedDelete=(e,t)=>{B().fire({icon:"warning",title:"Are you sure?",showCloseButton:!0,showCancelButton:!0,focusConfirm:!0,confirmButtonText:"Yes",confirmButtonAriaLabel:"Yes",cancelButtonText:"No",cancelButtonAriaLabel:"Thumbs down"}).then((s=>{s.value&&this.props.ACTION_DELETE_FEED(e,t,this.onDeleteUpdateRedux(t))}))},this.onDeleteUpdateRedux=e=>{this.props.getModeration(),this.countAllPage()},this.handleMessage=async e=>{try{const t=(0,v.KK)(e.data),{code:s,networkId:n,type:a}=t;"manageFeed"==a&&s&&await(0,W.CJ)(parseInt(n),s,this.props.GET_FEEDS)}catch(t){console.log("--- handleMessage error ---",t)}},this.getPagination=()=>{const{currentPage:e,totalPage:t}=this.state,s=[];if(t<=5)for(let n=1;n<=t;n++)s.push(n);else e<=3?s.push(1,2,3,4,"...",t):e>t-3?s.push(1,"...",t-3,t-2,t-1,t):s.push(1,"...",e-1,e,e+1,"...",t);return s}}componentDidMount(){window.addEventListener("message",this.handleMessage),this.props.GET_FEEDS(),this.countAllPage()}componentDidUpdate(e,t){var s,n,a,i,l;if(null!==(s=this.props.manageFeeds)&&void 0!==s&&s.loading||this.props.wallsLoader||null!==(n=this.props.manageFeeds)&&void 0!==n&&null!==(a=n.feeds)&&void 0!==a&&a.length){if(1==(null===(i=this.props.manageFeeds)||void 0===i||null===(l=i.feeds)||void 0===l?void 0:l.length)){var o;const{id:e,networkId:t}=null===(o=this.props.manageFeeds)||void 0===o?void 0:o.feeds[0];if(0==e&&0==t){const e=localStorage.getItem("wallId");e&&this.props.navigate(`/content/addfeed/${e}`)}}}else{const e=localStorage.getItem("wallId");e&&this.props.navigate(`/content/addfeed/${e}`)}}componentWillUnmount(){window.removeEventListener("message",this.handleMessage)}render(){var e,t,s;const{currentPage:n,showPost:a,totalPage:c,allFeeds:r,accountChanged:h}=this.state,{manageFeeds:m,wallsLoader:u,allWalls:p,navigate:g}=this.props,x=(this.getPagination(),(n-1)*a),y=(r>0&&r.slice(x,x+a),null!==(e=null===p||void 0===p?void 0:p.find((e=>e.id==localStorage.getItem("wallId"))))&&void 0!==e?e:{});return(0,f.jsxs)(f.Fragment,{children:[null!==p&&void 0!==p&&p.length?(0,f.jsx)(q.A,{crumbs:[{name:null!==(t=null===y||void 0===y?void 0:y.name)&&void 0!==t?t:"",icon:"grid-2-plus",imgUrl:null!==(s=null===y||void 0===y?void 0:y.thumbnail)&&void 0!==s?s:""},{name:"Home",link:"/home"},{name:"Content Gallery",link:"/content"},{name:null===y||void 0===y?void 0:y.name,link:`/content/moderation/${null===y||void 0===y?void 0:y.id}`},{name:"Manage feeds",link:`/content/managefeed/${(null===y||void 0===y?void 0:y.id)||localStorage.getItem("wallId")||""}`}],RightComponent:(0,f.jsx)("div",{children:m.loading||u?null:p&&p.length>0?(0,f.jsxs)("button",{onClick:()=>(0,j.Yj)("networkManager","manageFeed",!0)?g(`/content/addfeed/${localStorage.getItem("wallId")}`):{},className:"btn btn-primary btn-md text-nowrap btn-min-w text-capitalize",children:[(0,f.jsx)(w.gc,{icon:"plus",iconClass:"me-1"}),"Add feed"]}):(0,f.jsxs)(i.A,{size:"sm",className:"text-nowrap btn-min-w",onClick:()=>(0,j.Yj)("contentGallery","createGallery",!0)?this.props.TOGGLE_ADD_GALLERY(!0):{},children:[(0,f.jsx)(w.gc,{icon:"plus",iconClass:"me-1"}),"Add Gallery"]})}),showGallerySwitcher:!1},null===y||void 0===y?void 0:y.id):null,(0,f.jsx)("div",{className:"d-flex flex-column flex-column-fluid full-content mt-10 mt-lg-0",children:(0,f.jsx)(l.A,{className:(0,v.C2)()?"":"container-mange-feed",children:(0,f.jsxs)(o.A,{children:[(0,f.jsx)("div",{onClick:()=>g(-1),style:{right:"15px",top:"10px",zIndex:"9",height:"20px",width:"20px",display:"flex",alignItems:"center",justifyContent:"center"},className:"position-absolute cursor-pointer rounded-2",children:(0,f.jsx)(w.gc,{icon:"xmark",iconClass:"cursor-pointer"})}),(0,f.jsx)(o.A.Body,{children:(0,f.jsx)("div",{className:"d-flex flex-column justify-content-between p-3 position-relative",style:{minHeight:"calc(100vh - 210px)"},children:m.loading||u?(0,f.jsx)("div",{style:{minHeight:"calc(100vh - 500px)"},children:(0,f.jsx)(G.a,{})}):p&&p.length>0?(0,f.jsx)("div",{className:"table-responsive",style:{minHeight:"calc(100vh - 235px)"},children:(0,f.jsxs)(d.A,{size:"lg",className:"pb-10",children:[(0,f.jsx)("thead",{className:"thead-light",children:(0,f.jsx)("tr",{children:Z.map(((e,t)=>(0,f.jsx)("th",{className:`fw-bold text-nowrap ${(null===e||void 0===e?void 0:e.align)||""}`,style:{minWidth:e.minWidth},children:e.name},t)))})}),(0,f.jsx)("tbody",{children:null!==m&&void 0!==m&&m.feeds&&null!==m&&void 0!==m&&m.feeds.length?null===m||void 0===m?void 0:m.feeds.map((e=>0!=(null===e||void 0===e?void 0:e.id)||0!=(null===e||void 0===e?void 0:e.networkId)?(0,f.jsx)(U,{feed:e,changeStatus:this.changeStatus,onFeedDelete:this.onFeedDelete,changeAccount:this.changeAccount,accountChanged:h},`tr_${e.id}`):null)):null})]})}):(0,f.jsx)("div",{className:"f-center",style:{minHeight:"calc(100vh - 225px)"},children:(0,f.jsx)(Y.A,{title:"Create a Gallery, to add feed! \u231b",desc:"Oops! Looks like you have deleted your gallery, create one by simply clicking on the button below.",icon:"media",button:{action:()=>(0,j.Yj)("contentGallery","createGallery",!0)?this.props.TOGGLE_ADD_GALLERY(!0):{},text:"Create Gallery"},isFullScreen:!1})})})})]})})})]})}}const Q=(0,a.Ng)((e=>{var t,s,n;return{manageFeeds:e.manageFeeds,wallsLoader:null===e||void 0===e||null===(t=e.dashboardData)||void 0===t?void 0:t.wallsLoader,allWalls:null===e||void 0===e||null===(s=e.dashboardData)||void 0===s||null===(n=s.dashboarddata)||void 0===n?void 0:n.allWalls}}),(e=>({GET_FEEDS:()=>e((0,c.LF)()),ACTION_DELETE_FEED:(t,s,n)=>e((0,c.sP)(t,s,n)),ACTION_FEED_STATUS:(t,s,n,a)=>e((0,c.X)(t,s,n,a)),ACTION_UPDATE_SOCIAL_ACCOUNT:(t,s,n)=>e((0,c.ZA)(t,s,n)),getModeration:()=>e((0,z.zI)()),TOGGLE_ADD_GALLERY:t=>e({type:H.GSH,payload:t}),SNAPUP_DETAILS_ACTION:t=>e((0,K.QR)(t))})))((0,R.A)(J))}}]);